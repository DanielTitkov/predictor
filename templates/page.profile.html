{{ define "title" }} Crowdsourced predictions {{ end }}
{{ define "view" }}
<main>
  {{ template "back-to-home" }}
  {{ if .User }}
  <div class="section">
    <div class="columns">
      <div class="column is-4">
        <div class="block has-text-centered">
          <figure class="image is-128x128">
            <img class="is-rounded" src="{{ .User.Picture }}" alt="userpic">
          </figure>
        </div>
        <div class="block has-text-left">
          <p>
            <b>–ò–º—è: </b>
            <span>{{ .User.Name }}</span>
          </p>
          <p>
            <b>Email: </b>
            <span>{{ .User.Email }}</span>
          </p>
          <p>
            <b>–Ø–∑—ã–∫: </b>
            <span>{{ .User.Locale }}</span>
          </p>
        </div>
      </div>
      <div class="column">
        <div class="box notification has-background-white">

          <h3 class="title is-3 has-text-centered">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
          <progress class="progress is-large user-summary-meter" value="{{ .UserSummary.PercCorrect }}" max="100">{{
            .UserSummary.PercCorrect }}%</progress>
          <hr>
          <div class="columns is-mobile is-size-4">
            <div class="column has-text-weight-semibold">
              –í–µ—Ä–Ω–æ
            </div>
            <div class="column is-3 has-text-right">
              {{ .UserSummary.PercCorrect }}%
            </div>
            <div class="column is-3 has-text-right">
              ({{ .UserSummary.CorrectPredictions }})
            </div>
          </div>
          <div class="columns is-mobile is-size-4">
            <div class="column has-text-weight-semibold">
              –ù–µ–≤–µ—Ä–Ω–æ
            </div>
            <div class="column is-3 has-text-right">
              {{ .UserSummary.PercIncorrect }}%
            </div>
            <div class="column is-3 has-text-right">
              ({{ .UserSummary.IncorrectPredictions }})
            </div>
          </div>
          <hr>
          <div class="columns is-mobile is-size-5">
            <div class="column has-text-weight-semibold">
              –û–∂–∏–¥–∞—é—Ç
            </div>
            <div class="column is-3 has-text-right">
            </div>
            <div class="column is-3 has-text-right">
              {{ .UserSummary.UnknownPredictions }}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- <div class="section">
    <h1 class="title is-3 has-text-centered">–ê—á–∏–≤–∫–∏</h1>
    {{ template "badge-selector" }}
  </div> -->
  <div class="section">
    <h1 class="title is-3 has-text-centered">–í–∞—à–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</h1>
    <div class="tabs is-large is-centered">
      <ul>
        <li class="{{ if .FilterArgs.Finished }}is-active{{end}}"><a live-click="select-finished">–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ</a></li>
        <li class="{{ if .FilterArgs.Ongoing }}is-active{{end}}"><a live-click="select-ongoing">–û—Ç–∫—Ä—ã—Ç—ã–µ</a></li>
        <li class="{{ if .ShowMine }}is-active{{end}}"><a live-click="select-mine">–ú–æ–∏</a></li>
        <li class="{{ if .CreateChallengeForm }}is-active{{end}}"><a live-click="create-new">–°–æ–∑–¥–∞—Ç—å</a></li>
      </ul>
    </div>
    {{ if .CreateChallengeForm }}
    <!-- if create challenge -->
    <div class="block">
      {{ if .CreatedChallenge }}
      <div class="block">
        <p class="title is-4 has-text-centered">Created challenge</p>
        {{ template "challenge-list-item" .CreatedChallenge }}
      </div>
      {{ else }}
      <form id="create-challenge-form" live-submit="create-new-submit" live-change="create-new-validate">
        {{ if .FormError }}
        <div class="block">
          <p class="title is-5 has-text-danger">
            {{ .FormError.Error }}
          </p>
        </div>
        {{ end }}
        <div class="field">
          <label class="label">Content</label>
          <div class="control">
            <input class="input" name="content" live-debounce="blur" type="text" placeholder="Content">
          </div>
        </div>
        <div class="field">
          <label class="label">Description</label>
          <div class="control">
            <input class="input" name="description" live-debounce="blur" type="text" placeholder="Description">
          </div>
        </div>
        <div class="columns">
          <div class="column is-6">
            <div class="field">
              <label class="label">Start time</label>
              <div class="control">
                <input class="input" name="start-time" live-debounce="blur" type="text" placeholder="{{ .TimeLayout }}">
              </div>
            </div>
          </div>
          <div class="column is-6">
            <div class="field">
              <label class="label">End time</label>
              <div class="control">
                <input class="input" name="end-time" live-debounce="blur" type="text" placeholder="{{ .TimeLayout }}">
              </div>
            </div>
          </div>
        </div>
        <hr>
        <div class="field is-grouped is-grouped-right">
          <div class="control">
            <button class="button is-link is-large is-rounded" {{ if .FormError }}disabled{{ end }}>
              Create challenge
            </button>
          </div>
        </div>
      </form>
      {{ end }}
    </div>
    {{ else }}
    <!-- else if create challenge -->
    <div class="level">
      <h4 class="title is-4">–ù–∞–π–¥–µ–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π: {{ .ChallengeCount }}</h4>
      <h4 class="subtitle is-5">–°—Ç—Ä–∞–Ω–∏—Ü–∞ <b>{{ .Page }}</b> –∏–∑ <b>{{ .MaxPage }}</b></h4>
    </div>
    <div class="block">
      {{ template "challenge-list-pagination" . }}
    </div>
    <div class="block">
      {{ if eq .ChallengeCount 0 }}
      <h5 class="title is-5">–ü–æ–∫–∞ –Ω–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º</h5>
      {{ else }}
      {{ range $i, $challenge := .Challenges }}
      <div class="columns">
        <div class="column is-8 is-align-self-center">
          {{ template "challenge-list-item" $challenge }}
        </div>
        {{ if $challenge.UserPrediction }}
        <div class="column is-align-self-center">
          <div class="columns is-mobile">
            <div class="column is-narrow is-size-1 is-align-self-center has-text-centered-tablet">
              <p class="is-family-monospace">
                {{ if $challenge.HasOutcome }}
                {{ if eq $challenge.UserPrediction.Prognosis $challenge.HasOutcomeAndTrue }}
                &equals;
                {{ else }}
                &NotEqual;
                {{ end }}
                {{ else }}
                ?
                {{ end }}
              </p>
            </div>
            <div class="column is-narrow is-align-self-center has-text-centered-tablet">
              {{ template "prognosis-tag" $challenge.UserPrediction.Prognosis }}
            </div>
            <div class="column is-narrow is-align-self-center has-text-right is-size-1">
              {{ if $challenge.HasOutcome }}
              {{ if eq $challenge.UserPrediction.Prognosis $challenge.HasOutcomeAndTrue }}
              ü§©
              {{ else }}
              üôÑ
              {{ end }}
              {{ else }}
              ü•∫
              {{ end }}
            </div>
          </div>
        </div>
        {{ end }}
        <!-- end if user prediction -->
      </div>
      <hr class="is-hidden-tablet">
      {{ end }}
      {{ end }}
    </div>
    <div class="block">
      {{ template "challenge-list-pagination" . }}
    </div>
    {{ end }}
    <!-- end if create challenge -->
  </div>
  {{ end }}
  <!-- end if user -->
</main>
{{ end }}

{{ define "prognosis-tag" }}
<span class="tag px-5 py-6 {{ if . }}prognosis-tag-true{{ else }}prognosis-tag-false{{ end }} is-large">
  –ü—Ä–æ–≥–Ω–æ–∑:&nbsp;
  {{ if . }}
  <i class="bi-check-circle-fill" style="font-size: 2rem;"></i>
  {{ else }}
  <i class="bi-x-circle-fill" style="font-size: 2rem;"></i>
  {{ end }}
</span>
{{ end }}